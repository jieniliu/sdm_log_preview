(()=>{"use strict";var e={3315:(e,a,l)=>{var t=l(5130),s=l(2167),r=(l(4188),l(6768));const i={class:"app-container"};function o(e,a){const l=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",i,[(0,r.bF)(l)])}var d=l(1241);const c={},n=(0,d.A)(c,[["render",o]]),m=n;var _=l(1387),u=l(4232);const p={class:"log-data-container"},g={class:"filter-container"},v={class:"filter-group"},b={class:"filter-item"},h={class:"filter-item"},k={class:"filter-group"},f={class:"filter-item"},y={class:"filter-group filter-button-group"},L={class:"data-display-section"},w={class:"custom-metric-card"},F={class:"metric-value"},x={class:"custom-metric-card"},V={class:"metric-value"},D={class:"custom-metric-card"},S={class:"metric-value"},z={class:"custom-metric-card"},U={class:"metric-value"},C={class:"roaming-flow-container"},N={class:"flow-arrow"},T={class:"arrow-label"},M={class:"flow-arrow"},Y={class:"arrow-label"},W={class:"flow-arrow"},O={class:"arrow-label"},A={class:"flow-arrow"},X={class:"arrow-label"},j={class:"roaming-stats"},E={class:"stat-item"},H={class:"stat-value"},G={class:"stat-item"},R={class:"stat-value"},q={class:"metric-card-inner"},I={class:"metric-card-label",style:{width:"100px"}},P={class:"metric-card-value",style:{"margin-left":"10px","min-width":"100px"}},K={class:"metric-card-percent",style:{"margin-left":"10px","min-width":"40px",color:"var(--text-secondary)"}},Q={class:"metric-card-inner"},$={class:"metric-card-label",style:{width:"100px"}},B={class:"metric-card-value",style:{"margin-left":"10px","min-width":"100px"}},J={class:"metric-card-percent",style:{"margin-left":"10px","min-width":"40px",color:"var(--text-secondary)"}},Z={class:"table-wrapper"},ee={class:"table-wrapper"},ae={class:"table-wrapper"},le={class:"table-wrapper"},te={class:"table-wrapper"},se={class:"user-logs-filter-bar",style:{"margin-bottom":"16px",display:"flex","flex-wrap":"wrap",gap:"12px","align-items":"center"}},re={class:"table-wrapper"},ie={class:"user-logs-filter-bar",style:{"margin-bottom":"16px",display:"flex","flex-wrap":"wrap",gap:"12px","align-items":"center"}},oe={class:"table-wrapper"};function de(e,a,l,t,s,i){const o=(0,r.g2)("el-date-picker"),d=(0,r.g2)("el-option"),c=(0,r.g2)("el-select"),n=(0,r.g2)("el-button"),m=(0,r.g2)("el-card"),_=(0,r.g2)("el-col"),de=(0,r.g2)("el-row"),ce=(0,r.g2)("el-table-column"),ne=(0,r.g2)("el-table"),me=(0,r.g2)("el-input");return(0,r.uX)(),(0,r.CE)("div",p,[a[50]||(a[50]=(0,r.Lk)("h1",{class:"page-title"},"日志数据中心",-1)),(0,r.bF)(m,{class:"filter-card"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",g,[(0,r.Lk)("div",v,[(0,r.Lk)("div",b,[a[18]||(a[18]=(0,r.Lk)("span",{class:"filter-label"},"开始时间：",-1)),(0,r.bF)(o,{modelValue:s.filters.startTime,"onUpdate:modelValue":a[0]||(a[0]=e=>s.filters.startTime=e),type:"datetime",placeholder:"选择开始时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"x",size:"small",class:"custom-date-picker dark-date-input","popper-class":"dark-date-picker",clearable:!0,"clear-icon":"el-icon-circle-close"},null,8,["modelValue"])]),(0,r.Lk)("div",h,[a[19]||(a[19]=(0,r.Lk)("span",{class:"filter-label"},"结束时间：",-1)),(0,r.bF)(o,{modelValue:s.filters.endTime,"onUpdate:modelValue":a[1]||(a[1]=e=>s.filters.endTime=e),type:"datetime",placeholder:"选择结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"x",size:"small",class:"custom-date-picker dark-date-input","popper-class":"dark-date-picker",clearable:!0,"clear-icon":"el-icon-circle-close"},null,8,["modelValue"])])]),(0,r.Lk)("div",k,[(0,r.Lk)("div",f,[a[20]||(a[20]=(0,r.Lk)("span",{class:"filter-label"},"消息类型：",-1)),(0,r.bF)(c,{modelValue:s.filters.messageType,"onUpdate:modelValue":a[2]||(a[2]=e=>s.filters.messageType=e),placeholder:"请选择消息类型",clearable:"",size:"small","popper-class":"dark-select-dropdown",class:"dark-select",onChange:i.onMessageTypeChange},{default:(0,r.k6)((()=>[(0,r.bF)(d,{label:"文本消息",value:"m.text"}),(0,r.bF)(d,{label:"图片消息",value:"m.image"}),(0,r.bF)(d,{label:"视频消息",value:"m.video"}),(0,r.bF)(d,{label:"语音消息",value:"m.audio"}),(0,r.bF)(d,{label:"图库消息",value:"m.gallery"}),(0,r.bF)(d,{label:"文件消息",value:"m.file"})])),_:1},8,["modelValue","onChange"])])]),(0,r.Lk)("div",y,[(0,r.bF)(n,{type:"primary",onClick:i.fetchData,size:"small",class:"query-button"},{default:(0,r.k6)((()=>a[21]||(a[21]=[(0,r.eW)("查询")]))),_:1,__:[21]},8,["onClick"])])])])),_:1}),(0,r.Lk)("div",L,[(0,r.bF)(de,{gutter:20},{default:(0,r.k6)((()=>[(0,r.bF)(_,{xs:24,sm:6,md:6,lg:6,xl:6},{default:(0,r.k6)((()=>[(0,r.Lk)("div",w,[(0,r.Lk)("div",F,(0,u.v_)(s.logData.user_count||0),1),a[22]||(a[22]=(0,r.Lk)("div",{class:"metric-title"},"用户数量",-1))])])),_:1}),(0,r.bF)(_,{xs:24,sm:6,md:6,lg:6,xl:6},{default:(0,r.k6)((()=>[(0,r.Lk)("div",x,[(0,r.Lk)("div",V,(0,u.v_)(i.formatNumber(s.logData.avg_socket_time?.average_response_time||0)),1),a[23]||(a[23]=(0,r.Lk)("div",{class:"metric-title"},"Socket响应时间 (ms)",-1))])])),_:1}),(0,r.bF)(_,{xs:24,sm:6,md:6,lg:6,xl:6},{default:(0,r.k6)((()=>[(0,r.Lk)("div",D,[(0,r.Lk)("div",S,(0,u.v_)(i.formatNumber(s.logData.roaming_message_avg_time||0)),1),a[24]||(a[24]=(0,r.Lk)("div",{class:"metric-title"},"漫游消息接收时间 (ms)",-1))])])),_:1}),(0,r.bF)(_,{xs:24,sm:6,md:6,lg:6,xl:6},{default:(0,r.k6)((()=>[(0,r.Lk)("div",z,[(0,r.Lk)("div",U,(0,u.v_)(i.formatNumber(s.logData.delay_message_avg_time||0)),1),a[25]||(a[25]=(0,r.Lk)("div",{class:"metric-title"},"在线状态接收消息耗时 (ms)",-1))])])),_:1})])),_:1}),s.logData.avg_roaming_response?((0,r.uX)(),(0,r.Wv)(m,{key:0,class:"roaming-flow-card"},{header:(0,r.k6)((()=>a[26]||(a[26]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"漫游消息流程耗时")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",C,[a[31]||(a[31]=(0,r.Lk)("div",{class:"flow-node",id:"socket-connected"},[(0,r.Lk)("div",{class:"node-content"},"socket_connected")],-1)),(0,r.Lk)("div",N,[a[27]||(a[27]=(0,r.Lk)("div",{class:"arrow-line"},null,-1)),(0,r.Lk)("div",T,(0,u.v_)(i.formatNumber(3e-4))+"ms",1)]),a[32]||(a[32]=(0,r.Lk)("div",{class:"flow-node",id:"receive-seqs"},[(0,r.Lk)("div",{class:"node-content"},"receive_seqs_updated_response")],-1)),(0,r.Lk)("div",M,[a[28]||(a[28]=(0,r.Lk)("div",{class:"arrow-line"},null,-1)),(0,r.Lk)("div",Y,(0,u.v_)(i.formatNumber(s.logData.avg_roaming_response?.append_need_update_room_avg||0))+"ms",1)]),a[33]||(a[33]=(0,r.Lk)("div",{class:"flow-node",id:"append-need"},[(0,r.Lk)("div",{class:"node-content"},"append_need_update_room")],-1)),(0,r.Lk)("div",W,[a[29]||(a[29]=(0,r.Lk)("div",{class:"arrow-line"},null,-1)),(0,r.Lk)("div",O,(0,u.v_)(i.formatNumber(s.logData.avg_roaming_response?.roaming_get_messages_from_server_avg||0))+"ms",1)]),a[34]||(a[34]=(0,r.Lk)("div",{class:"flow-node",id:"get-messages"},[(0,r.Lk)("div",{class:"node-content"},"roaming_get_messages_from_server")],-1)),(0,r.Lk)("div",A,[a[30]||(a[30]=(0,r.Lk)("div",{class:"arrow-line"},null,-1)),(0,r.Lk)("div",X,(0,u.v_)(i.formatNumber(s.logData.avg_roaming_response?.roaming_receive_message_avg||0))+"ms",1)]),a[35]||(a[35]=(0,r.Lk)("div",{class:"flow-node",id:"receive-message"},[(0,r.Lk)("div",{class:"node-content"},"roaming_receive_message")],-1))]),(0,r.Lk)("div",j,[(0,r.Lk)("div",E,[a[36]||(a[36]=(0,r.Lk)("span",{class:"stat-label"},"receive_seqs_updated_response 平均耗时:",-1)),(0,r.Lk)("span",H,(0,u.v_)(i.formatNumber(s.logData.avg_roaming_response?.receive_seqs_updated_response_avg||0))+"ms",1)]),(0,r.Lk)("div",G,[a[37]||(a[37]=(0,r.Lk)("span",{class:"stat-label"},"总平均耗时:",-1)),(0,r.Lk)("span",R,(0,u.v_)(i.formatNumber(s.logData.avg_roaming_response?.total_avg||0))+"ms",1)])])])),_:1})):(0,r.Q3)("",!0),(0,r.bF)(de,{gutter:20,style:{"margin-bottom":"24px"}},{default:(0,r.k6)((()=>["m.text"!==s.filters.messageType&&s.filters.messageType?((0,r.uX)(),(0,r.Wv)(_,{key:1,xs:24,sm:12,md:12,lg:12,xl:12},{default:(0,r.k6)((()=>[(0,r.bF)(m,{class:"table-card custom-table-card",style:{height:"100%"}},{header:(0,r.k6)((()=>a[39]||(a[39]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"附件消息耗时分布")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",Q,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.attachmentMessageAvgList,((e,a)=>((0,r.uX)(),(0,r.CE)("div",{key:a,style:{"margin-bottom":"10px",display:"flex","align-items":"center"}},[(0,r.Lk)("span",$,(0,u.v_)(e.label),1),(0,r.Lk)("span",B,(0,u.v_)(e.value)+" ms",1),(0,r.Lk)("span",J,(0,u.v_)(e.percent)+"%",1)])))),128))])])),_:1})])),_:1})):((0,r.uX)(),(0,r.Wv)(_,{key:0,xs:24,sm:12,md:12,lg:12,xl:12},{default:(0,r.k6)((()=>[(0,r.bF)(m,{class:"table-card custom-table-card",style:{height:"100%"}},{header:(0,r.k6)((()=>a[38]||(a[38]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"文本消息耗时分布")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",q,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.textMessageAvgList,((e,a)=>((0,r.uX)(),(0,r.CE)("div",{key:a,style:{"margin-bottom":"10px",display:"flex","align-items":"center"}},[(0,r.Lk)("span",I,(0,u.v_)(e.label),1),(0,r.Lk)("span",P,(0,u.v_)(e.value)+" ms",1),(0,r.Lk)("span",K,(0,u.v_)(e.percent)+"%",1)])))),128))])])),_:1})])),_:1}))])),_:1}),(0,r.bF)(de,{gutter:20},{default:(0,r.k6)((()=>[(0,r.bF)(_,{xs:24,sm:24,md:16,lg:16,xl:16},{default:(0,r.k6)((()=>[(0,r.bF)(m,{class:"table-card custom-table-card",style:{"margin-bottom":"20px"}},{header:(0,r.k6)((()=>a[40]||(a[40]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"消息相关")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",Z,[(0,r.bF)(ne,{data:i.actionGroup.message,size:"small",stripe:"",style:{width:"100%"},class:"dark-table custom-border-table no-header-line"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{prop:"name",label:"事件","min-width":"120"}),(0,r.bF)(ce,{prop:"value",label:"数值",width:"100",align:"right"}),(0,r.bF)(ce,{prop:"key",label:"字段","min-width":"140","class-name":"field-column"})])),_:1},8,["data"])])])),_:1}),(0,r.bF)(m,{class:"table-card custom-table-card",style:{"margin-bottom":"20px"}},{header:(0,r.k6)((()=>a[41]||(a[41]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"加解密相关")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",ee,[(0,r.bF)(ne,{data:i.actionGroup.crypto,size:"small",stripe:"",style:{width:"100%"},class:"dark-table custom-border-table no-header-line"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{prop:"name",label:"事件","min-width":"120"}),(0,r.bF)(ce,{prop:"value",label:"数值",width:"100",align:"right"}),(0,r.bF)(ce,{prop:"key",label:"字段","min-width":"140","class-name":"field-column"})])),_:1},8,["data"])])])),_:1}),(0,r.bF)(m,{class:"table-card custom-table-card"},{header:(0,r.k6)((()=>a[42]||(a[42]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"房间/Socket相关")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",ae,[(0,r.bF)(ne,{data:i.actionGroup.roomSocket,size:"small",stripe:"",style:{width:"100%"},class:"dark-table custom-border-table no-header-line"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{prop:"name",label:"事件","min-width":"120"}),(0,r.bF)(ce,{prop:"value",label:"数值",width:"100",align:"right"}),(0,r.bF)(ce,{prop:"key",label:"字段","min-width":"140","class-name":"field-column"})])),_:1},8,["data"])])])),_:1})])),_:1}),(0,r.bF)(_,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,r.k6)((()=>[(0,r.bF)(m,{class:"table-card custom-table-card"},{header:(0,r.k6)((()=>a[43]||(a[43]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"上传相关")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",le,[(0,r.bF)(ne,{data:i.actionGroup.upload,size:"small",stripe:"",style:{width:"100%"},class:"dark-table custom-border-table no-header-line"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{prop:"name",label:"事件","min-width":"120"}),(0,r.bF)(ce,{prop:"value",label:"数值",width:"100",align:"right"}),(0,r.bF)(ce,{prop:"key",label:"字段","min-width":"140","class-name":"field-column"})])),_:1},8,["data"])])])),_:1})])),_:1})])),_:1}),i.actionGroup.other.length?((0,r.uX)(),(0,r.Wv)(de,{key:1},{default:(0,r.k6)((()=>[(0,r.bF)(_,{span:24},{default:(0,r.k6)((()=>[(0,r.bF)(m,{class:"table-card custom-table-card"},{header:(0,r.k6)((()=>a[44]||(a[44]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"其它操作")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",te,[(0,r.bF)(ne,{data:i.actionGroup.other,size:"small",stripe:"",style:{width:"100%"},class:"dark-table custom-border-table no-header-line"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{prop:"name",label:"事件","min-width":"120"}),(0,r.bF)(ce,{prop:"value",label:"数值",width:"100",align:"right"}),(0,r.bF)(ce,{prop:"key",label:"字段","min-width":"140","class-name":"field-column"})])),_:1},8,["data"])])])),_:1})])),_:1})])),_:1})):(0,r.Q3)("",!0),s.logData.user_logs&&s.logData.user_logs.length?((0,r.uX)(),(0,r.Wv)(m,{key:2,class:"table-card custom-table-card",style:{"margin-top":"32px"}},{header:(0,r.k6)((()=>a[45]||(a[45]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"用户日志明细")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",se,[(0,r.bF)(me,{modelValue:s.userLogsFilter.device_id,"onUpdate:modelValue":a[3]||(a[3]=e=>s.userLogsFilter.device_id=e),placeholder:"筛选 device_id",size:"small",class:"dark-input",clearable:"",style:{width:"180px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsFilter.launch_id,"onUpdate:modelValue":a[4]||(a[4]=e=>s.userLogsFilter.launch_id=e),placeholder:"筛选 launch_id",size:"small",class:"dark-input",clearable:"",style:{width:"180px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsFilter.event_type,"onUpdate:modelValue":a[5]||(a[5]=e=>s.userLogsFilter.event_type=e),placeholder:"筛选 event_type",size:"small",class:"dark-input",clearable:"",style:{width:"180px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsFilter.event_id,"onUpdate:modelValue":a[6]||(a[6]=e=>s.userLogsFilter.event_id=e),placeholder:"筛选 event_id",size:"small",class:"dark-input",clearable:"",style:{width:"180px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsFilter.local_event_id,"onUpdate:modelValue":a[7]||(a[7]=e=>s.userLogsFilter.local_event_id=e),placeholder:"筛选 local_event_id",size:"small",class:"dark-input",clearable:"",style:{width:"180px"}},null,8,["modelValue"]),(0,r.bF)(n,{size:"small",onClick:i.clearUserLogsFilter,type:"info"},{default:(0,r.k6)((()=>a[46]||(a[46]=[(0,r.eW)("重置")]))),_:1,__:[46]},8,["onClick"])]),(0,r.Lk)("div",re,[(0,r.bF)(ne,{data:i.filteredUserLogs,size:"small",stripe:"",style:{width:"100%"},class:"dark-table custom-border-table no-header-line"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{prop:"sdn_url",label:"sdn_url","min-width":"160"}),(0,r.bF)(ce,{prop:"trace_id",label:"trace_id","min-width":"180"}),(0,r.bF)(ce,{prop:"user_id",label:"user_id","min-width":"220"}),(0,r.bF)(ce,{prop:"platform",label:"platform","min-width":"100"}),(0,r.bF)(ce,{prop:"device_id",label:"device_id","min-width":"180"}),(0,r.bF)(ce,{prop:"launch_id",label:"launch_id","min-width":"180"}),(0,r.bF)(ce,{prop:"action_type",label:"action_type","min-width":"160"}),(0,r.bF)(ce,{prop:"room_id",label:"room_id","min-width":"160"}),(0,r.bF)(ce,{prop:"event_type",label:"event_type","min-width":"160"}),(0,r.bF)(ce,{prop:"message_type",label:"message_type","min-width":"160"}),(0,r.bF)(ce,{prop:"local_event_id",label:"local_event_id","min-width":"180"}),(0,r.bF)(ce,{prop:"event_id",label:"event_id","min-width":"180"}),(0,r.bF)(ce,{prop:"other",label:"other","min-width":"120"}),(0,r.bF)(ce,{prop:"timestamp",label:"timestamp","min-width":"180"})])),_:1},8,["data"])])])),_:1})):(0,r.Q3)("",!0),(0,r.bF)(m,{class:"table-card custom-table-card",style:{"margin-top":"32px"}},{header:(0,r.k6)((()=>a[47]||(a[47]=[(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h3",null,"用户日志搜索")],-1)]))),default:(0,r.k6)((()=>[(0,r.Lk)("div",ie,[(0,r.bF)(o,{modelValue:s.userLogsSearch.start_at,"onUpdate:modelValue":a[8]||(a[8]=e=>s.userLogsSearch.start_at=e),type:"datetime",placeholder:"开始时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"x",size:"small",class:"dark-date-input",style:{width:"180px"}},null,8,["modelValue"]),(0,r.bF)(o,{modelValue:s.userLogsSearch.end_at,"onUpdate:modelValue":a[9]||(a[9]=e=>s.userLogsSearch.end_at=e),type:"datetime",placeholder:"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"x",size:"small",class:"dark-date-input",style:{width:"180px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.user_id,"onUpdate:modelValue":a[10]||(a[10]=e=>s.userLogsSearch.user_id=e),placeholder:"user_id",size:"small",class:"dark-input",clearable:"",style:{width:"160px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.device_id,"onUpdate:modelValue":a[11]||(a[11]=e=>s.userLogsSearch.device_id=e),placeholder:"device_id",size:"small",class:"dark-input",clearable:"",style:{width:"140px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.launch_id,"onUpdate:modelValue":a[12]||(a[12]=e=>s.userLogsSearch.launch_id=e),placeholder:"launch_id",size:"small",class:"dark-input",clearable:"",style:{width:"140px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.action_type,"onUpdate:modelValue":a[13]||(a[13]=e=>s.userLogsSearch.action_type=e),placeholder:"action_type",size:"small",class:"dark-input",clearable:"",style:{width:"140px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.room_id,"onUpdate:modelValue":a[14]||(a[14]=e=>s.userLogsSearch.room_id=e),placeholder:"room_id",size:"small",class:"dark-input",clearable:"",style:{width:"140px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.message_type,"onUpdate:modelValue":a[15]||(a[15]=e=>s.userLogsSearch.message_type=e),placeholder:"message_type",size:"small",class:"dark-input",clearable:"",style:{width:"140px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.event_id,"onUpdate:modelValue":a[16]||(a[16]=e=>s.userLogsSearch.event_id=e),placeholder:"event_id",size:"small",class:"dark-input",clearable:"",style:{width:"140px"}},null,8,["modelValue"]),(0,r.bF)(me,{modelValue:s.userLogsSearch.local_event_id,"onUpdate:modelValue":a[17]||(a[17]=e=>s.userLogsSearch.local_event_id=e),placeholder:"local_event_id",size:"small",class:"dark-input",clearable:"",style:{width:"140px"}},null,8,["modelValue"]),(0,r.bF)(n,{size:"small",type:"primary",onClick:i.searchUserLogs},{default:(0,r.k6)((()=>a[48]||(a[48]=[(0,r.eW)("搜索")]))),_:1,__:[48]},8,["onClick"]),(0,r.bF)(n,{size:"small",onClick:i.clearUserLogsSearch,type:"info"},{default:(0,r.k6)((()=>a[49]||(a[49]=[(0,r.eW)("重置")]))),_:1,__:[49]},8,["onClick"])]),(0,r.Lk)("div",oe,[(0,r.bF)(ne,{data:s.userLogsSearchResult,size:"small",stripe:"",style:{width:"100%"},class:"dark-table custom-border-table no-header-line"},{default:(0,r.k6)((()=>[(0,r.bF)(ce,{prop:"sdn_url",label:"sdn_url","min-width":"160"}),(0,r.bF)(ce,{prop:"trace_id",label:"trace_id","min-width":"180"}),(0,r.bF)(ce,{prop:"user_id",label:"user_id","min-width":"220"}),(0,r.bF)(ce,{prop:"platform",label:"platform","min-width":"100"}),(0,r.bF)(ce,{prop:"device_id",label:"device_id","min-width":"180"}),(0,r.bF)(ce,{prop:"launch_id",label:"launch_id","min-width":"180"}),(0,r.bF)(ce,{prop:"action_type",label:"action_type","min-width":"160"}),(0,r.bF)(ce,{prop:"room_id",label:"room_id","min-width":"160"}),(0,r.bF)(ce,{prop:"event_type",label:"event_type","min-width":"160"}),(0,r.bF)(ce,{prop:"message_type",label:"message_type","min-width":"160"}),(0,r.bF)(ce,{prop:"local_event_id",label:"local_event_id","min-width":"180"}),(0,r.bF)(ce,{prop:"event_id",label:"event_id","min-width":"180"}),(0,r.bF)(ce,{prop:"other",label:"other","min-width":"120"}),(0,r.bF)(ce,{prop:"timestamp",label:"timestamp","min-width":"180"})])),_:1},8,["data"])])])),_:1})])])}var ce=l(788),ne=l.n(ce);const me=ne().create({baseURL:"https://hs.sending.me",headers:{"Content-Type":"application/json"}}),_e={getLogSummary(e,a,l,t){return me.post("/_api/client/r0/log_center/summary_data_center",{start_at:e,end_at:a,message_type:l||void 0,user_id:t||void 0})},searchUserLogs(e){return me.post("/_api/client/r0/log_center/search_user_log",e)}};var ue=l(5320);function pe(e){return{action_type_count:e.action_type_count||{},avg_socket_time:e.avg_socket_time||{},user_count:e.user_count||0,roaming_message_avg_time:e.roaming_message_avg_time||0,delay_message_avg_time:e.delay_message_avg_time||0,avg_roaming_response:e.avg_roaming_response||{},attachment_message_avg_time:e.attachment_message_avg_time||{},text_message_avg_time:e.text_message_avg_time||{},...e}}const ge={name:"LogDataView",data(){return{filters:{startTime:Date.now()-6048e5,endTime:Date.now(),messageType:"m.text"},logData:{action_type_count:{},avg_socket_time:{},user_count:0,roaming_message_avg_time:0,delay_message_avg_time:0,attachment_message_avg_time:{},text_message_avg_time:{}},userLogsFilter:{device_id:"",launch_id:"",event_type:"",event_id:"",local_event_id:""},userLogsSearch:{start_at:0,end_at:Date.now(),user_id:"",device_id:"",launch_id:"",action_type:"",room_id:"",message_type:"",event_id:"",local_event_id:""},userLogsSearchResult:[]}},computed:{actionGroup(){const e={socket_disconnected_count:"socket断开次数",launch_count:"启动次数",enter_room_count:"进入房间次数",send_message_count:"发消息次数",send_success_count:"消息发送成功次数",send_fail_count:"消息发送失败次数",encrypt_event:"加密事件",encrypt_event_success:"加密成功",encrypt_event_failed:"加密失败",decrypt_event_failed:"解密失败",decrypt_event_success:"解密成功",upload_image:"上传图片",upload_image_success:"上传图片成功",upload_image_failed:"上传图片失败",upload_image_cancelled:"取消上传图片",upload_video:"上传视频",upload_video_success:"上传视频成功",upload_video_failed:"上传视频失败",upload_gallery_list:"上传图库",upload_gallery_list_success:"上传图库成功",upload_gallery_list_failed:"上传图库失败",upload_gallery_list_cancelled:"取消上传图库",upload_file:"上传文件",upload_file_success:"上传文件成功",upload_file_failed:"上传文件失败",upload_file_cancelled:"取消上传文件"},a=Object.entries(this.logData.action_type_count||{}).map((([a,l])=>({name:e[a]||a,value:l,key:a}))),l=a.filter((e=>e.key.startsWith("upload_"))),t=a.filter((e=>e.key.startsWith("encrypt_")||e.key.startsWith("decrypt_"))),s=a.filter((e=>e.key.startsWith("send_"))),r=a.filter((e=>["launch_count","enter_room_count","socket_disconnected_count"].includes(e.key))),i=new Set([...l,...t,...s,...r].map((e=>e.key))),o=a.filter((e=>!i.has(e.key))),d=e=>e.slice().sort(((e,a)=>e.key.localeCompare(a.key)));return{message:d(s),upload:d(l),crypto:d(t),roomSocket:d(r),other:d(o)}},timeData(){const e=[{key:"avg_socket_time",name:"socket链接时长",value:this.formatNumber(this.logData.avg_socket_time?.average_response_time||0)},{key:"roaming_message_avg_time",name:"漫游消息接收时间",value:this.formatNumber(this.logData.roaming_message_avg_time||0)},{key:"delay_message_avg_time",name:"在线状态接收消息耗时",value:this.formatNumber(this.logData.delay_message_avg_time||0)}];return e.filter((e=>Number(e.value)>0))},userLogsColumns(){const e=this.logData.user_logs||[];return e.length?Object.keys(e[0]).map((e=>({prop:e,label:e,minWidth:120}))):[]},filteredUserLogs(){const{device_id:e,launch_id:a,event_type:l,event_id:t,local_event_id:s}=this.userLogsFilter;return(this.logData.user_logs||[]).filter((r=>!(e&&!(r.device_id||"").includes(e))&&(!(a&&!(r.launch_id||"").includes(a))&&(!(l&&!(r.event_type||"").includes(l))&&(!(t&&!(r.event_id||"").includes(t))&&!(s&&!(r.local_event_id||"").includes(s)))))))},textMessageAvgList(){const e=this.logData.text_message_avg_time||{};e.send_text_message_avg_time;return[{label:"加密耗时",value:this.formatNumber(e.encrypt_avg_time||0),percent:0},{label:"API耗时",value:this.formatNumber(e.send_text_message_avg_time||0),percent:0}]},attachmentMessageAvgList(){const e=this.logData.attachment_message_avg_time||{},a=e.send_message_total_avg_time||1;return[{label:"上传耗时",value:this.formatNumber(e.upload_avg_time||0),percent:e.upload_avg_time&&a?Math.round(100*e.upload_avg_time/a):0},{label:"发送API耗时",value:this.formatNumber(e.send_message_api_avg_time||0),percent:e.send_message_api_avg_time&&a?Math.round(100*e.send_message_api_avg_time/a):0},{label:"总耗时",value:this.formatNumber(e.send_message_total_avg_time||0),percent:100}]}},mounted(){this.fetchData()},methods:{async fetchData(){let e=null;try{e=ue.Ks.service({lock:!0,text:"加载中...",background:"rgba(0,0,0,0.3)"});const a=await _e.getLogSummary(this.filters.startTime,this.filters.endTime,this.filters.messageType);this.logData=pe(a.data)}catch(a){console.error("获取日志数据失败:",a),this.$message.error("获取数据失败，请稍后重试")}finally{e&&e.close()}},formatNumber(e){return Number(e).toFixed(1)},clearUserLogsFilter(){this.userLogsFilter={device_id:"",launch_id:"",event_type:"",event_id:"",local_event_id:""}},async searchUserLogs(){try{const e={...this.userLogsSearch};e.start_at=Number(e.start_at)||0,e.end_at=Number(e.end_at)||Date.now();const{data:a}=await _e.searchUserLogs(e);this.userLogsSearchResult=Array.isArray(a)?a:[]}catch(e){this.userLogsSearchResult=[],this.$message.error("用户日志搜索失败")}},clearUserLogsSearch(){this.userLogsSearch={start_at:0,end_at:Date.now(),user_id:"",device_id:"",launch_id:"",action_type:"",room_id:"",message_type:"",event_id:"",local_event_id:""},this.userLogsSearchResult=[]},onMessageTypeChange(){this.fetchData()}}},ve=(0,d.A)(ge,[["render",de],["__scopeId","data-v-f8aa5faa"]]),be=ve,he=[{path:"/",name:"home",component:be}],ke=(0,_.aE)({history:(0,_.LA)("/sdm_log_preview/"),routes:he}),fe=ke,ye=(0,t.Ef)(m);ye.use(s.A),ye.use(fe),ye.mount("#app")}},a={};function l(t){var s=a[t];if(void 0!==s)return s.exports;var r=a[t]={exports:{}};return e[t].call(r.exports,r,r.exports,l),r.exports}l.m=e,(()=>{var e=[];l.O=(a,t,s,r)=>{if(!t){var i=1/0;for(n=0;n<e.length;n++){for(var[t,s,r]=e[n],o=!0,d=0;d<t.length;d++)(!1&r||i>=r)&&Object.keys(l.O).every((e=>l.O[e](t[d])))?t.splice(d--,1):(o=!1,r<i&&(i=r));if(o){e.splice(n--,1);var c=s();void 0!==c&&(a=c)}}return a}r=r||0;for(var n=e.length;n>0&&e[n-1][2]>r;n--)e[n]=e[n-1];e[n]=[t,s,r]}})(),(()=>{l.n=e=>{var a=e&&e.__esModule?()=>e["default"]:()=>e;return l.d(a,{a}),a}})(),(()=>{l.d=(e,a)=>{for(var t in a)l.o(a,t)&&!l.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}})(),(()=>{l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{l.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a)})(),(()=>{var e={524:0};l.O.j=a=>0===e[a];var a=(a,t)=>{var s,r,[i,o,d]=t,c=0;if(i.some((a=>0!==e[a]))){for(s in o)l.o(o,s)&&(l.m[s]=o[s]);if(d)var n=d(l)}for(a&&a(t);c<i.length;c++)r=i[c],l.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return l.O(n)},t=self["webpackChunklog_data_visualization"]=self["webpackChunklog_data_visualization"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var t=l.O(void 0,[504],(()=>l(3315)));t=l.O(t)})();
//# sourceMappingURL=app.8dd6b609.js.map